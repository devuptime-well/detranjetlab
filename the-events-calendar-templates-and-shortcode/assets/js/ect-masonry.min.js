(function(t){function e(e,a,n){var r=e.parents(".ect-masonry-template-cont").find("#ect-lm-settings"),d=r.data("ajax-url"),i=r.data("settings"),o=r.attr("data-exclude-events"),c=r.data("load-more"),s=r.data("loading"),l=r.data("loaded"),f=r.siblings("#ect-query-arg").html(),m=JSON.parse(f);if("loadmore"==n){e.find(".ect-preloader").show(),e.find("span").text(s);var p=a.find(".ect-categories li.ect-active"),u=p.attr("data-filter"),h=p.attr("data-posts"),g=p.attr("data-pages"),v=p.attr("data-paged")}else{p=e,u=p.attr("data-filter"),h=p.attr("data-posts"),g=p.attr("data-pages");r.find("#ect-cat-load-more").show();v=e.attr("data-paged")}var y={action:"ect_catfilters_load_more",query:m,paged:v,cat:u,exclude_events:o,"per-page":h,settings:i};return jQuery.post(d,y,function(d){var i=JSON.parse(d);"yes"==i.events?setTimeout(function(){var d=i.content;if(t.each(d,function(e,n){var r=t(n);a.find(".ect-masonary-cont").append(r).masonry("appended",r,!0)}),v=parseInt(v)+1,i.exclude_events){var s=JSON.parse(o);newExcludeList=s.concat(JSON.parse(i.exclude_events)),r.attr("data-exclude-events","["+newExcludeList+"]")}"loadmore"==n?(p.attr("data-paged",v),e.find("span").text(c),e.find(".ect-preloader").hide()):(e.attr("data-paged",v),e.attr("data-prefetch","true"),r.find("#ect-cat-load-more").hide(),g>0&&a.find(".ect-masonay-load-more").find(".ect-load-more-btn").show())},1e3):(e.find(".ect-preloader").hide(),e.find("span").text(l),setTimeout(function(){if("loadmore"==n)e.hide().find("span").text(c),r.find("#ect-cat-load-more").hide();else{i.content;e.attr("data-prefetch","true"),r.find("#ect-cat-load-more").hide(),a.find(".ect-masonay-load-more").find(".ect-load-more-btn").hide()}},1500))}),!1}jQuery(document).ready(function(t){t(".ect-masonry-template-cont").each(function(){var a=t(this),n=a.find(".ect-masonary-cont");n.find(".ect-grid-event").first().addClass("grid-sizer"),n.imagesLoaded(function(){n.masonry({gutterWidth:15,isAnimated:!0,itemSelector:".ect-grid-event",columnWidth:".grid-sizer",percentPosition:!0})}),a.find(".ect-categories li").click(function(e){e.preventDefault();var a=t(this).attr("data-filter");n.masonryFilter({filter:function(){if(!a)return!0;var e=t(this).attr("data-filter");return e.includes(a)}})}),a.find(".ect-categories li").on("click",function(){t(this).addClass("ect-active").siblings().removeClass("ect-active");t(this).attr("data-posts");var n=parseInt(t(this).attr("data-pages")),r=t(this),d=(r.attr("data-filter"),t(this).attr("data-prefetch"));"false"==d?(t(".ect-masonay-load-more").find(".ect-load-more-btn").hide(),e(r,a,"catcontent")):n>0&&t(".ect-masonay-load-more").find(".ect-load-more-btn").show()}),a.find(".ect-masonay-load-more").find(".ect-load-more-btn").on("click",function(){var n=t(this);return e(n,a,"loadmore"),!1})})})})(jQuery);